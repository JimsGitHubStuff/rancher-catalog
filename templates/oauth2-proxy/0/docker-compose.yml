version: '2'
services:
  oauth2proxy:
    image: jsimonovski/oauth2-proxy
    command: >
      oauth2_proxy 
      --email-domain="${email_domain}"
      --upstream=${upstream_service_url}
      --cookie-secret=${cookie_secret}
      --client-id=${client_id}
      --client-secret=${client_secret}
    labels:
      io.rancher.scheduler.affinity: app_host
      io.rancher.container.pull_image: always
      io.rancher.container.network: true
      traefik.enable: true
      traefik.frontend.rule: Host:logs.teampirate.io
      traefik.port: 4180